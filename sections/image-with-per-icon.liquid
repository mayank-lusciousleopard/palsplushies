{% style %}
.dragon-love {
  padding-top: {{ section.settings.padding_top }}px;
  padding-bottom: {{ section.settings.padding_bottom }}px;
}

.dragon-love__grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 48px;
  align-items: center;
}

.dragon-love__image-wrapper {
  position: relative;
  width: 100%;
  overflow: hidden;
  border-radius: 40px;
}

.dragon-love__image-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.dragon-love__image-wrapper.adapt { aspect-ratio: auto; }
.dragon-love__image-wrapper.square { aspect-ratio: 1 / 1; }
.dragon-love__image-wrapper.landscape { aspect-ratio: 4 / 3; }
.dragon-love__image-wrapper.portrait { aspect-ratio: 3 / 4; }

.dragon-love__content {
  text-align: {{ section.settings.text_alignment_desktop }};
}

.dragon-love__content h2 {
  margin-bottom: 24px;
  font-size: {{ section.settings.heading_size_desktop }}px;
  font-family: {{ section.settings.heading_font.family }}, {{ section.settings.heading_font.fallback_families }};
  font-weight: {{ section.settings.heading_weight }};
  color: {{ section.settings.heading_color }};
  text-align: {{ section.settings.heading_alignment_desktop }};
}

{% if section.settings.heading_bold %}
.dragon-love__content h2 {
  font-weight: 700;
}
{% endif %}

.dragon-love__stats {
  display: grid;
  gap: 20px;
  margin-bottom: 24px;
  text-align: {{ section.settings.text_alignment_desktop }};
}

.dragon-love__stat {
  display: flex;
  align-items: baseline;
  gap: 12px;
  justify-content: 
    {% if section.settings.text_alignment_desktop == 'left' %}
      flex-start;
    {% elsif section.settings.text_alignment_desktop == 'center' %}
      center;
    {% else %}
      flex-end;
    {% endif %}
}

.dragon-love__percent {
  font-size: 35px;
  font-weight: 700;
  line-height: 1;
  font-family: {{ section.settings.percent_font.family }}, {{ section.settings.percent_font.fallback_families }};
  color: black;
}

.dragon-love__text {
  font-size: {{ section.settings.text_size_desktop }}px;
  font-family: {{ section.settings.text_font.family }}, {{ section.settings.text_font.fallback_families }};
  color: black;
}

.dragon-love__subtext {
  font-size: 13px;
  opacity: 0.7;
  font-family: {{ section.settings.text_font.family }}, {{ section.settings.text_font.fallback_families }};
  color: black;
  text-align: {{ section.settings.text_alignment_desktop }};
}

@media (max-width: 768px) {
  .dragon-love__grid {
    grid-template-columns: 1fr;
    gap: 32px;
  }

  .dragon-love__percent {
    font-size: 32px;
  }

  .dragon-love__content {
    text-align: {{ section.settings.text_alignment_mobile }};
  }

  .dragon-love__content h2 {
    font-size: {{ section.settings.heading_size_mobile }}px;
    text-align: {{ section.settings.heading_alignment_mobile }};
  }

  .dragon-love__stats {
    text-align: {{ section.settings.text_alignment_mobile }};
  }

  .dragon-love__stat {
    justify-content:
      {% if section.settings.text_alignment_mobile == 'left' %}
        flex-start;
      {% elsif section.settings.text_alignment_mobile == 'center' %}
        center;
      {% else %}
        flex-end;
      {% endif %}
  }

  .dragon-love__text {
    font-size: {{ section.settings.text_size_mobile }}px;
  }

  .dragon-love__subtext {
    text-align: {{ section.settings.text_alignment_mobile }};
  }
}
{% endstyle %}

<section class="dragon-love color-{{ section.settings.color_scheme }}">
  <div class="page-width">
    <div class="dragon-love__grid">

      {% for block in section.blocks %}
        {% case block.type %}

          {% when 'image' %}
            <div class="dragon-love__image" {{ block.shopify_attributes }}>
              {% if block.settings.image != blank %}
                {% if block.settings.image_link != blank %}
                  <a href="{{ block.settings.image_link }}">
                {% endif %}

                <div class="dragon-love__image-wrapper {{ block.settings.image_ratio }}">
                  {{ block.settings.image | image_url: width: 1000 | image_tag }}
                </div>

                {% if block.settings.image_link != blank %}
                  </a>
                {% endif %}
              {% endif %}
            </div>

          {% when 'content' %}
            <div class="dragon-love__content" {{ block.shopify_attributes }}>
              {% if block.settings.heading != blank %}
                <h2>{{ block.settings.heading }}</h2>
              {% endif %}

              <div class="dragon-love__stats">
                {% for i in (1..3) %}
                  {% assign percent_key = 'percent_' | append: i %}
                  {% assign text_key = 'text_' | append: i %}

                  {% assign percent = block.settings[percent_key] %}
                  {% assign text = block.settings[text_key] %}

                  {% if percent != blank and text != blank %}
                    <div class="dragon-love__stat">
                      <div class="dragon-love__percent">{{ percent }}%</div>
                      <div class="dragon-love__text">{{ text }}</div>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>

              {% if block.settings.subtext != blank %}
                <div class="dragon-love__subtext">
                  {{ block.settings.subtext }}
                </div>
              {% endif %}
            </div>

        {% endcase %}
      {% endfor %}

    </div>
  </div>
</section>

{% schema %}
{
  "name": "Dragon Love Stats",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "background-1"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#111111"
    },
    {
      "type": "select",
      "id": "text_alignment_desktop",
      "label": "Text alignment (Desktop)",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "select",
      "id": "text_alignment_mobile",
      "label": "Text alignment (Mobile)",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "font_picker",
      "id": "heading_font",
      "label": "Heading font",
      "default": "assistant_n4"
    },
    {
      "type": "range",
      "id": "heading_size_desktop",
      "label": "Heading font size (Desktop)",
      "min": 20,
      "max": 80,
      "step": 2,
      "default": 40
    },
    {
      "type": "range",
      "id": "heading_size_mobile",
      "label": "Heading font size (Mobile)",
      "min": 14,
      "max": 60,
      "step": 2,
      "default": 32
    },
    {
      "type": "select",
      "id": "heading_alignment_desktop",
      "label": "Heading alignment (Desktop)",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "select",
      "id": "heading_alignment_mobile",
      "label": "Heading alignment (Mobile)",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "heading_weight",
      "label": "Heading font weight",
      "options": [
        { "value": "400", "label": "Regular" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semi Bold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "600"
    },
    {
      "type": "checkbox",
      "id": "heading_bold",
      "label": "Force bold heading",
      "default": false
    },
    {
      "type": "font_picker",
      "id": "percent_font",
      "label": "Percentage font",
      "default": "assistant_n7"
    },
    {
      "type": "font_picker",
      "id": "text_font",
      "label": "Text font",
      "default": "assistant_n4"
    },
    {
      "type": "range",
      "id": "text_size_desktop",
      "label": "Text font size (Desktop)",
      "min": 12,
      "max": 40,
      "step": 1,
      "default": 16
    },
    {
      "type": "range",
      "id": "text_size_mobile",
      "label": "Text font size (Mobile)",
      "min": 10,
      "max": 30,
      "step": 1,
      "default": 14
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top",
      "min": 0,
      "max": 120,
      "step": 4,
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom",
      "min": 0,
      "max": 120,
      "step": 4,
      "default": 60
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Image",
      "limit": 1,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "url",
          "id": "image_link",
          "label": "Image link"
        },
        {
          "type": "select",
          "id": "image_ratio",
          "label": "Image aspect ratio",
          "default": "adapt",
          "options": [
            { "value": "adapt", "label": "Adapt" },
            { "value": "square", "label": "Square (1:1)" },
            { "value": "landscape", "label": "Landscape (4:3)" },
            { "value": "portrait", "label": "Portrait (3:4)" }
          ]
        }
      ]
    },
    {
      "type": "content",
      "name": "Content",
      "limit": 1,
      "settings": [
        { "type": "text", "id": "heading", "label": "Heading", "default": "Feel the Dragon Love" },
        { "type": "text", "id": "percent_1", "label": "Percentage 1", "default": "92" },
        { "type": "text", "id": "text_1", "label": "Text 1", "default": "snuggle time increased" },
        { "type": "text", "id": "percent_2", "label": "Percentage 2", "default": "88" },
        { "type": "text", "id": "text_2", "label": "Text 2", "default": "playtime creativity boosted" },
        { "type": "text", "id": "percent_3", "label": "Percentage 3", "default": "95" },
        { "type": "text", "id": "text_3", "label": "Text 3", "default": "smiles and giggles unleashed" },
        { "type": "textarea", "id": "subtext", "label": "Sub text", "default": "Statistics are based on customer surveys. Individual results may vary." }
      ]
    }
  ],
  "presets": [
    {
      "name": "image with text number",
      "blocks": [
        { "type": "image" },
        { "type": "content" }
      ]
    }
  ]
}
{% endschema %}
